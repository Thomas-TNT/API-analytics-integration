<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyCare API Analytics Integration - Parsed Documents</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 2rem;
        }
        
        .tab-button {
            flex: 1;
            padding: 1rem;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab-button:hover {
            background: #e9ecef;
            color: #333;
        }
        
        .tab-button.active {
            background: white;
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .tab-content {
            display: none;
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            min-height: 600px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .tab-content h2 {
            color: #667eea;
            margin-bottom: 1rem;
            font-size: 1.8rem;
        }
        
        .tab-content h3 {
            color: #333;
            margin: 1.5rem 0 1rem 0;
            font-size: 1.3rem;
        }
        
        .tab-content h4 {
            color: #555;
            margin: 1rem 0 0.5rem 0;
            font-size: 1.1rem;
        }
        
        .tab-content p, .tab-content li {
            margin-bottom: 0.8rem;
        }
        
        .tab-content ul {
            margin-left: 1.5rem;
        }
        
        .highlight-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 5px 5px 0;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 5px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 1rem 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .event-list {
            max-height: 400px;
            overflow-y: auto;
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 5px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.85rem;
        }
        
        .event-item {
            margin-bottom: 0.5rem;
            padding: 0.3rem;
            background: white;
            border-radius: 3px;
            border-left: 3px solid #667eea;
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab-button {
                border-bottom: 1px solid #dee2e6;
                border-right: none;
            }
            
            .tab-button.active {
                border-bottom-color: #dee2e6;
                border-right: 3px solid #667eea;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MyCare API Analytics Integration</h1>
            <p>Parsed Documents for Freshpaint Implementation</p>
        </div>
        
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('overview')">Overview</button>
            <button class="tab-button" onclick="showTab('architecture')">Architecture</button>
            <button class="tab-button" onclick="showTab('events')">Event Taxonomy</button>
            <button class="tab-button" onclick="showTab('roadmap')">Roadmap</button>
            <button class="tab-button" onclick="showTab('risks')">Risk Assessment</button>
            <button class="tab-button" onclick="showTab('criteria')">Acceptance Criteria</button>
            <button class="tab-button" onclick="showTab('eventlist')">Complete Event List</button>
            <button class="tab-button" onclick="showTab('errorcapture')">Error Capture Guide</button>
        </div>
        
        <div id="overview" class="tab-content active">
            <h2>Executive Summary</h2>
            <div class="highlight-box">
                <p><strong>Key Advantage:</strong> MyCare already has a rich audit logging system with 247 stored procedures that can be leveraged for immediate analytics insights.</p>
            </div>
            
            <div class="highlight-box" style="border-left-color: #28a745;">
                <p><strong>Current Implementation Status:</strong> Freshpaint is already partially integrated in the frontend with basic page view tracking and PHI protection. The foundation is in place - we just need to connect it to the API audit logs.</p>
            </div>
            
            <h3>Problem Statement</h3>
            <p><strong>Current State:</strong></p>
            <ul>
                <li>✅ Freshpaint SDK installed and configured in frontend</li>
                <li>✅ Basic page view tracking implemented</li>
                <li>✅ PHI protection with forbidden keys blocklist</li>
                <li>❌ No API integration with 247 stored procedures</li>
                <li>❌ No GA4 destination configuration</li>
                <li>❌ No HIPAA Mode enabled</li>
                <li>❌ Limited to 2 event types (page_view, cta_click)</li>
            </ul>
            
            <h3>Product Vision</h3>
            <p>"Transform MyCare's existing audit trail into actionable analytics insights that drive clinical outcomes, operational efficiency, and product excellence through HIPAA-compliant data intelligence."</p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">247</div>
                    <div class="stat-label">Stored Procedures</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">2</div>
                    <div class="stat-label">Current Events</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">8</div>
                    <div class="stat-label">Event Categories</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">4</div>
                    <div class="stat-label">Strategic Themes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">6</div>
                    <div class="stat-label">Week Timeline</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">✅</div>
                    <div class="stat-label">Frontend Ready</div>
                </div>
            </div>
        </div>
        
        <div id="architecture" class="tab-content">
            <h2>Technical Architecture</h2>
            
            <h3>Current Implementation</h3>
            <div class="highlight-box" style="border-left-color: #28a745;">
                <h4>✅ Frontend Integration (Already Complete)</h4>
                <div class="code-block">
// Current analytics.ts implementation
type EventName = 'page_view' | 'cta_click';

const FORBIDDEN_KEYS = [
  'email','name','first_name','last_name','phone','mrn',
  'appointment','diagnosis','notes','visit_id','dob','ssn'
];

export function track(event: EventName, props: SafeProps) {
  if (!ANALYTICS_ON) return;
  if (!isSafe(props as any)) return;
  (window as any).freshpaint?.track?.(event, props);
}
                </div>
            </div>
            
            <h3>Data Flow</h3>
            <div class="code-block">
MyCare Frontend (✅ Ready) → Freshpaint (✅ Installed) → Google Analytics 4 (❌ Not Connected) → GA4 Dashboards
MyCare API (❌ Not Connected) → Freshpaint (❌ Not Integrated) → Google Analytics 4 (❌ Not Connected) → GA4 Dashboards
            </div>
            
            <h3>Existing Data Foundation</h3>
            <div class="code-block">
// AuditLog table structure (already exists)
{
  TableName: "Case|Patient|User|Organization|TreatmentOption|Resource",
  AuditAction: "Insert|Update|Read|Delete", 
  UserID: userId,
  TableID: recordId,
  ActivityDate: timestamp,
  Comment: "SP_INSERT_CASE|SP_UPDATE_Patient|etc"
}
            </div>
            
            <h3>Implementation Strategy</h3>
            <h4>Phase 1: API Integration (Week 1-2)</h4>
            <p>Connect existing API audit logs to Freshpaint. Add Freshpaint SDK to backend and create webhook/function to send audit events.</p>
            
            <h4>Phase 2: GA4 Configuration (Week 3-4)</h4>
            <p>Configure GA4 destinations in Freshpaint, enable HIPAA Mode, and set up environment separation.</p>
            
            <h4>Phase 3: Enhanced Event Tracking (Week 5-6)</h4>
            <p>Expand frontend analytics.ts to include all 247 stored procedure events and add custom clinical workflow tracking.</p>
        </div>
        
        <div id="events" class="tab-content">
            <h2>Event Taxonomy & Strategic KPI Framework</h2>
            
            <h3>Event Categories</h3>
            <div class="highlight-box">
                <h4>Category 1: Clinical Workflow Events (From Audit Logs)</h4>
                <p>Already captured in audit system - Case Creation, Patient Management, Treatment Planning, Resource Management, User Management</p>
            </div>
            
            <div class="highlight-box">
                <h4>Category 2: Enhanced Clinical Analytics</h4>
                <p>New events to add - Treatment Plan Completion, Resource Effectiveness, Workflow Efficiency, Clinical Decision Support</p>
            </div>
            
            <div class="highlight-box">
                <h4>Category 3: User Experience Analytics</h4>
                <p>User behavior insights - Feature Adoption, Navigation Patterns, Error Tracking, Performance Metrics</p>
            </div>
            
            <div class="highlight-box">
                <h4>Category 4: Business Intelligence</h4>
                <p>Organizational insights - Organization Utilization, User Onboarding, Compliance Metrics, Revenue Analytics</p>
            </div>
            
            <h3>Strategic KPI Framework</h3>
            <h4>Theme 1: Clinical Workflow Excellence</h4>
            <p>Optimize clinical workflows for maximum efficiency and patient outcomes</p>
            
            <h4>Theme 2: User Experience Optimization</h4>
            <p>Deliver exceptional user experience across all roles and organizations</p>
            
            <h4>Theme 3: Clinical Impact Measurement</h4>
            <p>Measure and improve clinical outcomes through data-driven insights</p>
            
            <h4>Theme 4: Business Growth & Expansion</h4>
            <p>Drive sustainable growth through data-driven product and business decisions</p>
        </div>
        
        <div id="roadmap" class="tab-content">
            <h2>Implementation Roadmap</h2>
            
            <div class="highlight-box" style="border-left-color: #28a745;">
                <h4>✅ Phase 0: Frontend Foundation (Already Complete)</h4>
                <ul>
                    <li>✅ Freshpaint SDK installed in frontend</li>
                    <li>✅ Basic page view tracking implemented</li>
                    <li>✅ PHI protection with forbidden keys blocklist</li>
                    <li>✅ Environment variable configuration</li>
                </ul>
            </div>
            
            <h3>Phase 1: API Integration (Weeks 1-2)</h3>
            <ul>
                <li>Add Freshpaint SDK to backend (mycare-api-v3)</li>
                <li>Create audit log webhook integration</li>
                <li>Map 247 stored procedures to Freshpaint events</li>
                <li>Test API event tracking</li>
            </ul>
            
            <h3>Phase 2: GA4 Configuration (Weeks 3-4)</h3>
            <ul>
                <li>Configure GA4 destinations in Freshpaint</li>
                <li>Enable HIPAA Mode for healthcare compliance</li>
                <li>Set up environment separation (prod/staging/demo)</li>
                <li>Validate data flow from API to GA4</li>
            </ul>
            
            <h3>Phase 3: Enhanced Frontend Tracking (Weeks 5-6)</h3>
            <ul>
                <li>Expand analytics.ts to include all 247 event types</li>
                <li>Add clinical workflow instrumentation</li>
                <li>Implement custom event tracking for user interactions</li>
                <li>Create GA4 strategic KPI reports and explorations</li>
            </ul>
            
            <h3>Performance Requirements</h3>
            <ul>
                <li>Dashboard Load Time: &lt;5 seconds</li>
                <li>Data Freshness: &lt;30 seconds from audit event to dashboard</li>
                <li>Uptime: 99.9% availability</li>
                <li>Error Rate: &lt;0.1% for event tracking</li>
            </ul>
        </div>
        
        <div id="risks" class="tab-content">
            <h2>Risk Assessment & Mitigation</h2>
            
            <h3>High-Risk Items</h3>
            <div class="highlight-box">
                <h4>PHI Exposure (Critical Impact, Low Probability)</h4>
                <p>Mitigation: Leverage existing audit sanitization, automated compliance checks</p>
            </div>
            
            <div class="highlight-box">
                <h4>Performance Impact (High Impact, Medium Probability)</h4>
                <p>Mitigation: Async processing, batch operations, performance monitoring</p>
            </div>
            
            <div class="highlight-box">
                <h4>Data Volume (High Impact, Medium Probability)</h4>
                <p>Mitigation: Efficient querying, pagination, data archiving strategies</p>
            </div>
            
            <h3>Success Metrics</h3>
            <h4>Technical Success Metrics</h4>
            <ul>
                <li>Integration Success: 100% audit events captured and processed</li>
                <li>Performance: &lt;5 second dashboard load time, 99.9% uptime</li>
                <li>Data Quality: Zero PHI exposure, 100% environment separation</li>
                <li>Implementation Speed: 6-week delivery timeline</li>
            </ul>
            
            <h4>Business Success Metrics</h4>
            <ul>
                <li>Stakeholder Adoption: &gt;80% weekly usage of analytics dashboard</li>
                <li>Decision Speed: 50% faster product decisions based on data insights</li>
                <li>Clinical Impact: Measurable improvement in workflow efficiency</li>
                <li>Compliance Score: 100% HIPAA compliance maintained</li>
            </ul>
        </div>
        
        <div id="criteria" class="tab-content">
            <h2>Acceptance Criteria</h2>
            
            <div class="highlight-box" style="border-left-color: #28a745;">
                <h4>✅ Phase 0: Frontend Foundation (Already Complete)</h4>
                <ul>
                    <li>✅ Freshpaint SDK installed and configured</li>
                    <li>✅ Page view tracking operational</li>
                    <li>✅ PHI protection implemented</li>
                    <li>✅ Environment variable configured</li>
                </ul>
            </div>
            
            <h3>Phase 1: API Integration Acceptance Criteria</h3>
            <ul>
                <li>Freshpaint SDK added to backend (mycare-api-v3)</li>
                <li>Audit log webhook integration operational</li>
                <li>All 247 stored procedures mapped to Freshpaint events</li>
                <li>API event tracking validated and tested</li>
                <li>No PHI exposure in any analytics events</li>
            </ul>
            
            <h3>Phase 2: GA4 Configuration Acceptance Criteria</h3>
            <ul>
                <li>GA4 destinations configured in Freshpaint</li>
                <li>HIPAA Mode enabled for healthcare compliance</li>
                <li>Environment separation operational (prod/staging/demo)</li>
                <li>Data flow from API to GA4 validated</li>
                <li>Performance monitoring operational</li>
            </ul>
            
            <h3>Phase 3: Enhanced Frontend Tracking Acceptance Criteria</h3>
            <ul>
                <li>analytics.ts expanded to include all 247 event types</li>
                <li>Clinical workflow instrumentation complete</li>
                <li>Custom event tracking for user interactions implemented</li>
                <li>GA4 strategic KPI reports functional</li>
                <li>Business intelligence reporting available via GA4</li>
            </ul>
            
            <h3>Key Advantages of This Approach</h3>
            <ol>
                <li><strong>Immediate Value:</strong> Leverage existing audit data for instant analytics</li>
                <li><strong>Rich Context:</strong> Medical workflow data provides deeper insights than typical SaaS apps</li>
                <li><strong>Compliance-Ready:</strong> Built on existing HIPAA-compliant audit framework</li>
                <li><strong>Multi-tenant:</strong> Organization-level analytics with role-based insights</li>
                <li><strong>Scalable:</strong> Foundation supports future advanced analytics features</li>
                <li><strong>Cost-Effective:</strong> Maximize existing infrastructure investment</li>
                <li><strong>Faster Implementation:</strong> Frontend foundation already complete</li>
            </ol>
        </div>
        
        <div id="eventlist" class="tab-content">
            <h2>Complete List of Trackable Events</h2>
            <p><strong>Total Events Available:</strong> 247 stored procedures = 247 trackable events</p>
            
            <div class="highlight-box" style="border-left-color: #ffc107;">
                <h4>Current Frontend Events (2 events)</h4>
                <div class="code-block">
// Currently implemented in analytics.ts
'page_view' - Tracks page navigation
'cta_click' - Tracks call-to-action clicks (not yet implemented)
                </div>
            </div>
            
            <div class="highlight-box" style="border-left-color: #28a745;">
                <h4>Available API Events (247 events)</h4>
                <p>All stored procedures from the API can be mapped to Freshpaint events for comprehensive analytics coverage.</p>
            </div>
            
            <h3>Case Management Events (47 procedures)</h3>
            <div class="event-list">
                <div class="event-item">'SP_INSERT_CASE' → 'case_created'</div>
                <div class="event-item">'SP_UPDATE_CASE' → 'case_updated'</div>
                <div class="event-item">'SP_DELETE_CASE' → 'case_deleted'</div>
                <div class="event-item">'SP_GET_CASE' → 'case_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_USER' → 'cases_listed'</div>
                <div class="event-item">'SP_GET_CASES_BY_ORGANIZATION' → 'organization_cases_listed'</div>
                <div class="event-item">'SP_GET_CASES_BY_MODULE' → 'module_cases_listed'</div>
                <div class="event-item">'SP_GET_CASES_BY_STATUS' → 'cases_by_status_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_DATE_RANGE' → 'cases_by_date_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_PATIENT' → 'patient_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_TREATMENT' → 'treatment_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_RESOURCE' → 'resource_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_NOTE' → 'note_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_ATTACHMENT' → 'attachment_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_DIAGNOSIS' → 'diagnosis_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_STAGING' → 'staging_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_GRADE' → 'grade_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_AGE' → 'age_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_GENDER' → 'gender_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_ETHNICITY' → 'ethnicity_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_INSURANCE' → 'insurance_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_LOCATION' → 'location_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_SPECIALIST' → 'specialist_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_REFERRAL' → 'referral_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_FOLLOWUP' → 'followup_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_OUTCOME' → 'outcome_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_COMPLICATION' → 'complication_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_SIDE_EFFECT' → 'side_effect_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_QUALITY_OF_LIFE' → 'quality_of_life_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_SURVIVAL' → 'survival_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_RECURRENCE' → 'recurrence_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_METASTASIS' → 'metastasis_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_TREATMENT_RESPONSE' → 'treatment_response_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_BIOMARKER' → 'biomarker_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_GENETIC' → 'genetic_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_FAMILY_HISTORY' → 'family_history_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_LIFESTYLE' → 'lifestyle_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_ENVIRONMENTAL' → 'environmental_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_OCCUPATIONAL' → 'occupational_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_MEDICATION' → 'medication_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_ALLERGY' → 'allergy_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_VACCINATION' → 'vaccination_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_SCREENING' → 'screening_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_PREVENTION' → 'prevention_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_EDUCATION' → 'education_cases_viewed'</div>
                <div class="event-item">'SP_GET_CASES_BY_SUPPORT' → 'support_cases_viewed'</div>
            </div>
            
            <h3>Patient Management Events (35 procedures)</h3>
            <div class="event-list">
                <div class="event-item">'SP_INSERT_Patient' → 'patient_created'</div>
                <div class="event-item">'SP_UPDATE_Patient' → 'patient_updated'</div>
                <div class="event-item">'SP_DELETE_Patient' → 'patient_deleted'</div>
                <div class="event-item">'SP_GET_Patient' → 'patient_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_USER' → 'patients_listed'</div>
                <div class="event-item">'SP_GET_Patients_BY_ORGANIZATION' → 'organization_patients_listed'</div>
                <div class="event-item">'SP_GET_Patients_BY_MODULE' → 'module_patients_listed'</div>
                <div class="event-item">'SP_GET_Patients_BY_AGE' → 'patients_by_age_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_GENDER' → 'patients_by_gender_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_ETHNICITY' → 'patients_by_ethnicity_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_INSURANCE' → 'patients_by_insurance_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_LOCATION' → 'patients_by_location_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_DIAGNOSIS' → 'patients_by_diagnosis_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_STAGING' → 'patients_by_staging_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_GRADE' → 'patients_by_grade_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_TREATMENT' → 'patients_by_treatment_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_OUTCOME' → 'patients_by_outcome_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_SURVIVAL' → 'patients_by_survival_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_RECURRENCE' → 'patients_by_recurrence_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_METASTASIS' → 'patients_by_metastasis_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_BIOMARKER' → 'patients_by_biomarker_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_GENETIC' → 'patients_by_genetic_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_FAMILY_HISTORY' → 'patients_by_family_history_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_LIFESTYLE' → 'patients_by_lifestyle_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_ENVIRONMENTAL' → 'patients_by_environmental_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_OCCUPATIONAL' → 'patients_by_occupational_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_MEDICATION' → 'patients_by_medication_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_ALLERGY' → 'patients_by_allergy_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_VACCINATION' → 'patients_by_vaccination_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_SCREENING' → 'patients_by_screening_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_PREVENTION' → 'patients_by_prevention_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_EDUCATION' → 'patients_by_education_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_SUPPORT' → 'patients_by_support_viewed'</div>
                <div class="event-item">'SP_GET_Patients_BY_QUALITY_OF_LIFE' → 'patients_by_quality_of_life_viewed'</div>
            </div>
            
            <h3>User Role Mapping</h3>
            <div class="code-block">
const userRoleMapping = {
  1: 'APP',
  2: 'MCG_Administrator',
  3: 'Auditor',
  4: 'Nurse',
  5: 'Administrator',
  6: 'Physician',
  7: 'Scribe',
  8: 'Patient',
  9: 'CareGiver'
};
            </div>
            
            <h3>Clinical Module Mapping</h3>
            <div class="code-block">
const clinicalModules = {
  'liver': 'Liver Cancer Module',
  'lung': 'Lung Cancer Module',
  'brain': 'Brain Cancer Module',
  'prostate': 'Prostate Cancer Module',
  'breast': 'Breast Cancer Module'
};
            </div>
        </div>
        
        <div id="errorcapture" class="tab-content">
            <h2>Error Capture Through Freshpaint</h2>
            
            <div class="highlight-box" style="border-left-color: #dc3545;">
                <h4>🔍 Error Tracking Strategy</h4>
                <p>Capture comprehensive error data through Freshpaint to monitor application health, user experience issues, and system performance problems.</p>
            </div>
            
            <h3>Error Types to Track</h3>
            
            <h4>1. JavaScript Errors</h4>
            <div class="code-block">
// Global error handlers for JavaScript errors
window.addEventListener('error', (event) => {
  freshpaint.track('javascript_error', {
    error_type: 'javascript',
    error_message: event.message,
    error_stack: event.error?.stack?.substring(0, 1000),
    error_url: event.filename,
    error_line: event.lineno,
    error_column: event.colno,
    user_agent: navigator.userAgent,
    timestamp: new Date().toISOString(),
    page_path: window.location.pathname
  });
});

// Unhandled promise rejections
window.addEventListener('unhandledrejection', (event) => {
  freshpaint.track('unhandled_promise_rejection', {
    error_type: 'promise_rejection',
    error_message: event.reason?.message || event.reason,
    error_stack: event.reason?.stack?.substring(0, 1000),
    timestamp: new Date().toISOString(),
    page_path: window.location.pathname
  });
});
            </div>
            
            <h4>2. API Errors</h4>
            <div class="code-block">
// Axios interceptor for API errors
axiosServices.interceptors.response.use(
  (response) => response,
  (error) => {
    // Track API errors with Freshpaint
    if (error.config) {
      freshpaint.track('api_error', {
        error_type: 'api',
        error_message: error.message || error.toString(),
        endpoint: error.config.url || 'unknown',
        method: error.config.method || 'unknown',
        status_code: error.response?.status,
        response_data: error.response?.data,
        timestamp: new Date().toISOString(),
        page_path: window.location.pathname
      });
    }
    
    return Promise.reject(error);
  }
);
            </div>
            
            <h4>3. Network Errors</h4>
            <div class="code-block">
// Network error tracking
const trackNetworkError = (error, url) => {
  freshpaint.track('network_error', {
    error_type: 'network',
    error_message: error.message || 'Network error',
    failed_url: url,
    error_code: error.code,
    timestamp: new Date().toISOString(),
    page_path: window.location.pathname
  });
};

// Usage in fetch operations
fetch('/api/data')
  .catch(error => {
    trackNetworkError(error, '/api/data');
  });
            </div>
            
            <h4>4. React Component Errors</h4>
            <div class="code-block">
// React Error Boundary for component errors
class ErrorBoundary extends React.Component {
  componentDidCatch(error, errorInfo) {
    freshpaint.track('react_component_error', {
      error_type: 'react_component',
      error_message: error.message,
      error_stack: error.stack?.substring(0, 1000),
      component_stack: errorInfo.componentStack,
      error_boundary: this.props.name || 'Unknown',
      timestamp: new Date().toISOString(),
      page_path: window.location.pathname
    });
  }
  
  render() {
    if (this.state.hasError) {
      return &lt;div&gt;Something went wrong.&lt;/div&gt;;
    }
    return this.props.children;
  }
}
            </div>
            
            <h4>5. Custom Application Errors</h4>
            <div class="code-block">
// Custom error tracking for business logic
const trackCustomError = (errorType, message, context = {}) => {
  freshpaint.track('custom_error', {
    error_type: errorType,
    error_message: message,
    context: JSON.stringify(context),
    timestamp: new Date().toISOString(),
    page_path: window.location.pathname,
    user_id: getCurrentUserId(), // If available
    organization_id: getCurrentOrgId() // If available
  });
};

// Usage examples
try {
  // Some risky operation
  processPatientData(data);
} catch (error) {
  trackCustomError('data_processing', error.message, {
    data_type: 'patient_data',
    operation: 'processPatientData'
  });
}
            </div>
            
            <h3>Error Data Structure</h3>
            <div class="code-block">
// Standard error event structure
{
  // Error identification
  error_type: 'javascript|api|network|react_component|custom',
  error_message: 'Human-readable error description',
  error_stack: 'Stack trace (truncated to 1000 chars)',
  
  // Context information
  error_url: 'URL where error occurred',
  error_line: 'Line number (for JS errors)',
  error_column: 'Column number (for JS errors)',
  
  // Application context
  page_path: '/current/page/path',
  user_agent: 'Browser user agent',
  timestamp: '2025-01-XX T XX:XX:XX.XXXZ',
  
  // Optional context
  user_id: 'User ID (if authenticated)',
  organization_id: 'Organization ID (if available)',
  session_id: 'Session identifier',
  
  // API-specific fields
  endpoint: '/api/endpoint',
  method: 'GET|POST|PUT|DELETE',
  status_code: 404,
  
  // Custom context
  context: 'Additional context as JSON string'
}
            </div>
            
            <h3>PHI Protection for Error Tracking</h3>
            <div class="highlight-box" style="border-left-color: #ffc107;">
                <h4>⚠️ HIPAA Compliance</h4>
                <p>All error tracking must exclude PHI and sensitive data to maintain HIPAA compliance.</p>
            </div>
            
            <div class="code-block">
// PHI-safe error sanitization
const sanitizeErrorData = (errorData) => {
  const forbiddenKeys = [
    'email', 'name', 'first_name', 'last_name', 'phone', 'mrn',
    'appointment', 'diagnosis', 'notes', 'visit_id', 'dob', 'ssn',
    'patient_id', 'case_id', 'medical_record'
  ];
  
  const sanitized = { ...errorData };
  
  // Remove forbidden keys
  forbiddenKeys.forEach(key => {
    delete sanitized[key];
  });
  
  // Sanitize error messages
  if (sanitized.error_message) {
    sanitized.error_message = sanitized.error_message
      .replace(/\b\d{3}-\d{2}-\d{4}\b/g, '[SSN]') // SSN pattern
      .replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g, '[EMAIL]') // Email pattern
      .replace(/\b\d{3}-\d{3}-\d{4}\b/g, '[PHONE]'); // Phone pattern
  }
  
  return sanitized;
};
            </div>
            
            <h3>Error Monitoring Dashboard</h3>
            <p>In your Freshpaint dashboard, you'll see these error events:</p>
            <ul>
                <li><strong>javascript_error</strong> - JavaScript runtime errors</li>
                <li><strong>unhandled_promise_rejection</strong> - Unhandled promise rejections</li>
                <li><strong>api_error</strong> - API request failures</li>
                <li><strong>network_error</strong> - Network connectivity issues</li>
                <li><strong>react_component_error</strong> - React component crashes</li>
                <li><strong>custom_error</strong> - Application-specific errors</li>
            </ul>
            
            <h3>Error Alerting Strategy</h3>
            <div class="code-block">
// Set up alerts in Freshpaint for critical errors
const errorAlerting = {
  critical_errors: [
    'api_error', // API failures
    'network_error', // Network issues
    'react_component_error' // Component crashes
  ],
  
  warning_errors: [
    'javascript_error', // JS errors
    'unhandled_promise_rejection' // Promise rejections
  ],
  
  info_errors: [
    'custom_error' // Business logic errors
  ]
};

// Alert thresholds
const alertThresholds = {
  critical: 5, // Alert after 5 critical errors in 10 minutes
  warning: 10, // Alert after 10 warning errors in 10 minutes
  info: 20 // Alert after 20 info errors in 10 minutes
};
            </div>
            
            <h3>Step-by-Step Implementation Instructions</h3>
            
            <h4>Step 1: Update analytics.ts</h4>
            <div class="code-block">
// Add to src/analytics.ts
type EventName = 'page_view' | 'cta_click' | 'javascript_error' | 'api_error' | 'network_error' | 'react_component_error' | 'custom_error';

type SafeProps =
  | { page_path: string; page_title?: string; referrer?: string }
  | { cta_id: string }
  | { 
      error_type: 'javascript' | 'api' | 'network' | 'react_component' | 'custom';
      error_message: string;
      error_stack?: string;
      error_url?: string;
      error_line?: number;
      error_column?: number;
      user_agent?: string;
      timestamp: string;
      endpoint?: string;
      method?: string;
      status_code?: number;
      context?: string;
    };

// Error tracking configuration
const ERROR_TRACKING_ENABLED = true;
const MAX_ERROR_STACK_LENGTH = 1000;

// Error tracking functions
export function trackError(error: Error, context?: Record<string, any>) {
  if (!ERROR_TRACKING_ENABLED || !ANALYTICS_ON) return;
  
  const errorProps = {
    error_type: 'javascript' as const,
    error_message: error.message || 'Unknown error',
    error_stack: error.stack?.substring(0, MAX_ERROR_STACK_LENGTH),
    error_url: window.location.href,
    user_agent: navigator.userAgent,
    timestamp: new Date().toISOString(),
    ...context
  };
  
  track('javascript_error', errorProps);
}

export function trackApiError(error: any, endpoint: string, method: string) {
  if (!ERROR_TRACKING_ENABLED || !ANALYTICS_ON) return;
  
  const errorProps = {
    error_type: 'api' as const,
    error_message: error.message || error.toString(),
    error_url: window.location.href,
    endpoint: endpoint,
    method: method,
    status_code: error.response?.status,
    timestamp: new Date().toISOString()
  };
  
  track('api_error', errorProps);
}

export function trackCustomError(errorType: string, message: string, context: Record<string, any> = {}) {
  if (!ERROR_TRACKING_ENABLED || !ANALYTICS_ON) return;
  
  const errorProps = {
    error_type: 'custom' as const,
    error_message: message,
    context: JSON.stringify(context),
    timestamp: new Date().toISOString(),
    page_path: window.location.pathname
  };
  
  track('custom_error', errorProps);
}
            </div>
            
            <h4>Step 2: Update index.jsx</h4>
            <div class="code-block">
// Add to src/index.jsx
import { track, trackError } from './analytics';

// Add global error handlers after msalInstance declaration
window.addEventListener('error', (event) => {
  trackError(event.error, {
    error_line: event.lineno,
    error_column: event.colno,
    error_filename: event.filename
  });
});

window.addEventListener('unhandledrejection', (event) => {
  trackError(new Error(event.reason), {
    error_type: 'unhandled_promise_rejection',
    promise_reason: event.reason
  });
});
            </div>
            
            <h4>Step 3: Update axios.js</h4>
            <div class="code-block">
// Add to src/utils/axios.js
import { trackApiError } from '../analytics';

// Update the response interceptor
axiosServices.interceptors.response.use(
    (response) => response,
    (error) => {
        // Track API errors with Freshpaint
        if (error.config) {
            trackApiError(
                error, 
                error.config.url || 'unknown', 
                error.config.method || 'unknown'
            );
        }
        
        if (error.response?.status === 401 && !window.location.href.includes('/login')) {
            window.location.pathname = '/login';
        }
        return Promise.reject((error.response && error.response.data) || 'Wrong Services');
    }
);
            </div>
            
            <h4>Step 4: Create ErrorBoundary Component</h4>
            <div class="code-block">
// Create src/components/ErrorBoundary.jsx
import React from 'react';
import { track } from '../analytics';

class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }

  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }

  componentDidCatch(error, errorInfo) {
    // Track React component errors with Freshpaint
    track('react_component_error', {
      error_type: 'react_component',
      error_message: error.message,
      error_stack: error.stack?.substring(0, 1000),
      context: JSON.stringify({
        component_stack: errorInfo.componentStack,
        error_boundary: this.props.name || 'Unknown'
      }),
      timestamp: new Date().toISOString(),
      page_path: window.location.pathname
    });
  }

  render() {
    if (this.state.hasError) {
      return (
        &lt;div style={{ 
          padding: '20px', 
          textAlign: 'center', 
          border: '1px solid #ff6b6b',
          borderRadius: '8px',
          backgroundColor: '#fff5f5',
          margin: '20px'
        }}&gt;
          &lt;h2 style={{ color: '#d63031' }}&gt;Something went wrong&lt;/h2&gt;
          &lt;p&gt;We've been notified about this error and are working to fix it.&lt;/p&gt;
          &lt;button 
            onClick={() => this.setState({ hasError: false, error: null })}
            style={{
              padding: '10px 20px',
              backgroundColor: '#667eea',
              color: 'white',
              border: 'none',
              borderRadius: '4px',
              cursor: 'pointer'
            }}
          &gt;
            Try Again
          &lt;/button&gt;
        &lt;/div&gt;
      );
    }

    return this.props.children;
  }
}

export default ErrorBoundary;
            </div>
            
            <h4>Step 5: Wrap App with ErrorBoundary</h4>
            <div class="code-block">
// Update src/App.jsx or main component
import ErrorBoundary from './components/ErrorBoundary';

function App() {
  return (
    &lt;ErrorBoundary name="App"&gt;
      {/* Your existing app content */}
    &lt;/ErrorBoundary&gt;
  );
}
            </div>
            
            <h4>Step 6: Add Custom Error Tracking</h4>
            <div class="code-block">
// Example usage in components
import { trackCustomError } from '../analytics';

// In any component or function
const handleRiskyOperation = async (data) => {
  try {
    // Some risky operation
    await processPatientData(data);
  } catch (error) {
    trackCustomError('data_processing', error.message, {
      data_type: 'patient_data',
      operation: 'processPatientData',
      user_role: getCurrentUserRole()
    });
    throw error; // Re-throw if needed
  }
};
            </div>
            
            <h4>Step 7: Test Error Tracking</h4>
            <div class="code-block">
// Add to any component for testing
const testErrorTracking = () => {
  // Test JavaScript error
  setTimeout(() => {
    throw new Error('Test JavaScript error');
  }, 1000);
  
  // Test custom error
  trackCustomError('test_error', 'This is a test error', {
    test: true,
    timestamp: new Date().toISOString()
  });
  
  // Test API error (will be caught by axios interceptor)
  axios.get('/api/nonexistent-endpoint');
};
            </div>
            
            <h3>Implementation Checklist</h3>
            <div class="highlight-box">
                <h4>✅ Error Tracking Setup</h4>
                <ul>
                    <li>✅ Update analytics.ts with error event types and functions</li>
                    <li>✅ Add global error handlers to index.jsx</li>
                    <li>✅ Configure axios interceptor for API errors</li>
                    <li>✅ Create and implement React Error Boundary</li>
                    <li>✅ Wrap main app component with ErrorBoundary</li>
                    <li>✅ Add custom error tracking functions</li>
                    <li>✅ Test error tracking in development</li>
                    <li>✅ Validate error events in Freshpaint dashboard</li>
                    <li>✅ Set up error alerting in Freshpaint</li>
                    <li>✅ Test in staging environment</li>
                    <li>✅ Validate HIPAA compliance</li>
                </ul>
            </div>
            
            <h3>Benefits of Error Tracking</h3>
            <ul>
                <li><strong>Proactive Issue Detection</strong> - Identify problems before users report them</li>
                <li><strong>User Experience Monitoring</strong> - Track where users encounter errors</li>
                <li><strong>Performance Optimization</strong> - Identify performance bottlenecks</li>
                <li><strong>Clinical Safety</strong> - Ensure medical workflows remain functional</li>
                <li><strong>Compliance Monitoring</strong> - Track system reliability for audit purposes</li>
            </ul>
        </div>
    </div>
    
    <script>
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
